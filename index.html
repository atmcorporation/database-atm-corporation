<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PT HARAPAN UTAMA PRIMA</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        /* Styles here (same as provided earlier) */
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <img src="logo-placeholder.png" alt="Logo PT HARAPAN UTAMA PRIMA">
        <h1>PT HARAPAN UTAMA PRIMA</h1>
    </div>

    <!-- Login Form -->
    <div class="container" id="loginPage">
        <div class="form-container">
            <h2>Login</h2>
            <form id="loginForm">
                <input type="text" id="loginUsername" placeholder="Username" required>
                <input type="password" id="loginPassword" placeholder="Password" required>
                <button type="submit">Login</button>
            </form>
            <p>Belum punya akun? <a href="#" onclick="showRegister()">Daftar</a></p>
        </div>
    </div>

    <!-- Register Form -->
    <div class="container" id="registerPage" style="display: none;">
        <div class="form-container">
            <h2>Register</h2>
            <form id="registerForm">
                <input type="text" id="registerUsername" placeholder="Username" required>
                <input type="password" id="registerPassword" placeholder="Password" required>
                <button type="submit">Register</button>
            </form>
            <p>Sudah punya akun? <a href="#" onclick="showLogin()">Login</a></p>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard">
        <div class="dashboard-header">
            <h2>Data Karyawan</h2>
            <div>
                <button onclick="logout()">Logout</button>
                <button onclick="exportToExcel()">Export Excel</button>
                <input type="file" id="importExcel" onchange="importFromExcel()" style="display: none;">
                <button onclick="document.getElementById('importExcel').click()">Import Excel</button>
            </div>
        </div>

        <button onclick="addEmployee()">Tambah Karyawan</button>
        <input type="text" id="filterInput" placeholder="Filter data..." oninput="filterData()">

        <table>
            <thead>
                <tr>
                    <th>Nama</th>
                    <th>NIK</th>
                    <th>Posisi</th>
                    <th>Service Manager</th>
                    <th>Region</th>
                    <th>Cluster</th>
                    <th>No HP</th>
                    <th>Email</th>
                    <th>No KTP</th>
                    <th>Status Lisensi</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody id="employeeTable">
                <!-- Data karyawan diisi via JavaScript -->
            </tbody>
        </table>
    </div>

    <script>
        // Data
        let users = JSON.parse(localStorage.getItem('users')) || [];
        let employees = JSON.parse(localStorage.getItem('employees')) || [];

        // Login dan Logout
        function showLogin() {
            document.getElementById("loginPage").style.display = "flex";
            document.getElementById("registerPage").style.display = "none";
        }

        function showRegister() {
            document.getElementById("registerPage").style.display = "flex";
            document.getElementById("loginPage").style.display = "none";
        }

        document.getElementById("loginForm").addEventListener("submit", function (e) {
            e.preventDefault();
            const username = document.getElementById("loginUsername").value;
            const password = document.getElementById("loginPassword").value;

            const user = users.find(u => u.username === username && u.password === password);
            if (user) {
                localStorage.setItem('currentUser', JSON.stringify(user));
                document.getElementById("loginPage").style.display = "none";
                document.getElementById("dashboard").style.display = "block";
                loadEmployees();
            } else {
                alert("Username atau Password salah!");
            }
        });

        document.getElementById("registerForm").addEventListener("submit", function (e) {
            e.preventDefault();
            const username = document.getElementById("registerUsername").value;
            const password = document.getElementById("registerPassword").value;

            if (users.some(u => u.username === username)) {
                alert("Username sudah terdaftar!");
            } else {
                users.push({ username, password });
                localStorage.setItem('users', JSON.stringify(users));
                alert("Registrasi berhasil! Silakan login.");
                showLogin();
            }
        });

        function logout() {
            localStorage.removeItem('currentUser');
            document.getElementById("dashboard").style.display = "none";
            showLogin();
        }

        // Load Karyawan
        function loadEmployees() {
            const table = document.getElementById("employeeTable");
            table.innerHTML = "";
            employees.forEach((emp, index) => {
                const row = `<tr>
                    <td>${emp.nama}</td>
                    <td>${emp.nik}</td>
                    <td>${emp.posisi}</td>
                    <td>${emp.serviceManager}</td>
                    <td>${emp.region}</td>
                    <td>${emp.cluster}</td>
                    <td>${emp.noHp}</td>
                    <td>${emp.email}</td>
                    <td>${emp.noKtp}</td>
                    <td>${emp.statusLisensi}</td>
                    <td>
                        <button class="action-btn" onclick="editEmployee(${index})">Edit</button>
                        <button class="action-btn" onclick="deleteEmployee(${index})">Hapus</button>
                    </td>
                </tr>`;
                table.insertAdjacentHTML("beforeend", row);
            });
        }

        // Tambah Karyawan
        function addEmployee() {
            const nama = prompt("Nama Karyawan:");
            const nik = prompt("NIK:");
            const posisi = prompt("Posisi:");
            const serviceManager = prompt("Service Manager:");
            const region = prompt("Region:");
            const cluster = prompt("Cluster:");
            const noHp = prompt("No HP:");
            const email = prompt("Email:");
            const noKtp = prompt("No KTP:");
            const statusLisensi = prompt("Status Lisensi (Not Yet/Completed):");

            if (nama && nik) {
                employees.push({
                    nama, nik, posisi, serviceManager, region,
                    cluster, noHp, email, noKtp, statusLisensi
                });
                localStorage.setItem('employees', JSON.stringify(employees));
                loadEmployees();
            }
        }

        // Edit Karyawan
        function editEmployee(index) {
            const emp = employees[index];
            emp.nama = prompt("Nama Karyawan:", emp.nama) || emp.nama;
            emp.nik = prompt("NIK:", emp.nik) || emp.nik;
            emp.posisi = prompt("Posisi:", emp.posisi) || emp.posisi;
            emp.serviceManager = prompt("Service Manager:", emp.serviceManager) || emp.serviceManager;
            emp.region = prompt("Region:", emp.region) || emp.region;
            emp.cluster = prompt("Cluster:", emp.cluster) || emp.cluster;
            emp.noHp = prompt("No HP:", emp.noHp) || emp.noHp;
            emp.email = prompt("Email:", emp.email) || emp.email;
            emp.noKtp = prompt("No KTP:", emp.noKtp) || emp.noKtp;
            emp.statusLisensi = prompt("Status Lisensi:", emp.statusLisensi) || emp.statusLisensi;

            employees[index] = emp;
            localStorage.setItem('employees', JSON.stringify(employees));
            loadEmployees();
        }

        // Hapus Karyawan
        function deleteEmployee(index) {
            if (confirm("Yakin ingin menghapus data ini?")) {
                employees.splice(index, 1);
                localStorage.setItem('employees', JSON.stringify(employees));
                loadEmployees();
            }
        }

        // Filter Data
        function filterData() {
            const query = document.getElementById("filterInput").value.toLowerCase();
            const rows = document.querySelectorAll("#employeeTable tr");
            rows.forEach(row => {
                const text = row.innerText.toLowerCase();
                row.style.display = text.includes(query) ? "" : "none";
            });
        }

        // Import Excel
        function importFromExcel() {
            const file = document.getElementById("importExcel").files[0];
            const reader = new FileReader();

            reader.onload = function (e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: "array" });
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const json = XLSX.utils.sheet_to_json(sheet);

                employees = json.map(row => ({
                    nama: row.Nama || "",
                    nik: row.NIK || "",
                    posisi: row.Posisi || "",
                    serviceManager: row["Service Manager"] || "",
                    region: row.Region || "",
                    cluster: row.Cluster || "",
                    noHp: row["No HP"] || "",
                    email: row.Email || "",
                    noKtp: row["No KTP"] || "",
                    statusLisensi: row["Status Lisensi"] || "Not Yet"
                }));

                localStorage.setItem('employees', JSON.stringify(employees));
                loadEmployees();
           
